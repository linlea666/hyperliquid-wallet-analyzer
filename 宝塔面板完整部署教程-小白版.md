# 🚀 宝塔面板完整部署教程（小白版）

## 📋 准备工作

### 1. 确认信息

- ✅ GitHub 仓库：https://github.com/linlea666/hyperliquid-wallet-analyzer
- ✅ 服务器已安装宝塔面板
- ✅ 服务器已安装 Python 3.8+ 和 Node.js 16+

---

## 🎯 第一步：在服务器上克隆代码

### 1.1 登录宝塔面板

1. 打开浏览器，访问您的宝塔面板地址（如：`http://您的服务器IP:8888`）
2. 登录宝塔面板

### 1.2 打开终端

1. 点击左侧「**文件**」
2. 进入 `/www/wwwroot/` 目录
3. 点击右上角「**终端**」按钮

### 1.3 克隆代码

在终端中运行：

```bash
cd /www/wwwroot

# 克隆代码（Public 仓库，直接克隆）
git clone https://github.com/linlea666/hyperliquid-wallet-analyzer.git gendan

# 进入项目目录
cd gendan
```

**如果提示输入用户名密码**：
- Username: `linlea666`
- Password: 直接回车（Public 仓库不需要密码）

**如果网络问题**，可以使用镜像：
```bash
git clone https://ghproxy.com/https://github.com/linlea666/hyperliquid-wallet-analyzer.git gendan
```

---

## 🐍 第二步：配置 Python 后端

### 2.1 创建 Python 虚拟环境

在终端运行：

```bash
cd /www/wwwroot/gendan

# 创建虚拟环境
python3 -m venv venv

# 激活虚拟环境
source venv/bin/activate

# 安装依赖（使用国内镜像）
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r backend/requirements.txt
```

### 2.2 配置系统配置文件

```bash
# 复制示例配置文件
cp backend/data/config/system.json.example backend/data/config/system.json

# 编辑配置文件（如果需要修改 API 设置）
# 可以使用宝塔的文件管理器编辑，或使用 nano：
# nano backend/data/config/system.json
```

### 2.3 创建启动脚本

创建文件 `/www/wwwroot/gendan/start-backend.sh`：

```bash
#!/bin/bash
cd /www/wwwroot/gendan
source venv/bin/activate
cd backend
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

设置权限：
```bash
chmod +x start-backend.sh
```

---

## 📦 第三步：配置前端

### 3.1 安装前端依赖

在终端运行：

```bash
cd /www/wwwroot/gendan/frontend

# 使用国内镜像安装依赖
npm config set registry https://registry.npmmirror.com
npm install

# 构建前端
npm run build
```

构建完成后，前端文件会在 `frontend/dist/` 目录。

---

## ⚙️ 第四步：在宝塔面板配置 Python 项目

### 4.1 添加 Python 项目

1. 点击左侧「**Python项目**」
2. 点击「**添加Python项目**」
3. 填写信息：
   - **项目名称**：`gendan-backend`
   - **项目路径**：`/www/wwwroot/gendan`
   - **Python版本**：选择 Python 3.8 或更高版本
   - **框架**：`FastAPI`
   - **启动文件**：`backend/app/main.py`
   - **端口**：`8000`
   - **运行目录**：`/www/wwwroot/gendan/backend`
   - **虚拟环境**：`/www/wwwroot/gendan/venv`

4. 点击「**提交**」

### 4.2 配置启动命令

在 Python 项目设置中：
- **启动方式**：选择「命令行启动」
- **启动文件/命令**：
  ```
  uvicorn app.main:app --host 0.0.0.0 --port 8000
  ```

### 4.3 启动项目

1. 在 Python 项目列表中，找到 `gendan-backend`
2. 点击「**启动**」或「**重启**」
3. 查看日志，确认启动成功

---

## 🌐 第五步：配置 Nginx

### 5.1 添加网站

1. 点击左侧「**网站**」
2. 点击「**添加站点**」
3. 填写信息：
   - **域名**：您的域名（如：`wallet.yourdomain.com`）或服务器 IP
   - **备注**：`HyperLiquid 钱包分析系统`
   - **根目录**：`/www/wwwroot/gendan/frontend/dist`
   - **PHP版本**：纯静态（不需要 PHP）

4. 点击「**提交**」

### 5.2 配置反向代理

1. 点击网站右侧「**设置**」
2. 点击「**反向代理**」→「**添加反向代理**」
3. 填写信息：
   - **代理名称**：`api`
   - **目标URL**：`http://127.0.0.1:8000`
   - **发送域名**：`$host`
   - **内容替换**：不填

4. 点击「**提交**」

### 5.3 配置 API 路径

在网站设置中，点击「**配置文件**」，找到 `location /` 部分，修改为：

```nginx
location / {
    root /www/wwwroot/gendan/frontend/dist;
    try_files $uri $uri/ /index.html;
    index index.html;
}

# API 代理
location /api {
    proxy_pass http://127.0.0.1:8000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
```

点击「**保存**」

---

## 🔧 第六步：配置防火墙

### 6.1 开放端口

1. 点击左侧「**安全**」
2. 确保以下端口已开放：
   - **8000**（后端 API）
   - **80**（HTTP）
   - **443**（HTTPS，如果使用 SSL）

---

## ✅ 第七步：测试访问

### 7.1 测试后端 API

在浏览器访问：
```
http://您的域名或IP:8000/docs
```

应该能看到 FastAPI 的 API 文档页面。

### 7.2 测试前端

在浏览器访问：
```
http://您的域名或IP
```

应该能看到前端界面。

---

## 🔄 第八步：配置自动更新（可选）

### 8.1 创建更新脚本

创建文件 `/www/wwwroot/gendan/update.sh`：

```bash
#!/bin/bash
cd /www/wwwroot/gendan

echo "🔄 开始更新..."

# 拉取最新代码
git pull origin main

# 更新后端依赖（如果需要）
source venv/bin/activate
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r backend/requirements.txt

# 更新前端依赖并构建
cd frontend
npm install
npm run build

# 重启后端服务
# 在宝塔面板中手动重启，或使用 PM2：
# pm2 restart gendan-backend

echo "✅ 更新完成！"
echo "⚠️  请记得在宝塔面板重启 Python 项目"
```

设置权限：
```bash
chmod +x update.sh
```

### 8.2 使用更新脚本

以后更新代码时，在终端运行：

```bash
cd /www/wwwroot/gendan
./update.sh
```

然后在宝塔面板重启 Python 项目。

---

## 📋 完整配置清单

- ✅ 代码已克隆到 `/www/wwwroot/gendan`
- ✅ Python 虚拟环境已创建
- ✅ 后端依赖已安装
- ✅ 前端依赖已安装并构建
- ✅ Python 项目已在宝塔面板配置
- ✅ Nginx 网站已配置
- ✅ 反向代理已配置
- ✅ 端口已开放
- ✅ 服务已启动

---

## 🐛 常见问题

### Q1: Python 项目启动失败？

**A**: 
1. 检查虚拟环境是否正确
2. 检查依赖是否安装完整：`pip list`
3. 查看日志：在 Python 项目设置中查看「日志」

### Q2: 前端页面空白？

**A**: 
1. 确认前端已构建：`ls frontend/dist`
2. 检查 Nginx 配置的根目录是否正确
3. 检查浏览器控制台错误

### Q3: API 请求失败？

**A**: 
1. 检查后端是否运行：访问 `http://域名:8000/docs`
2. 检查 Nginx 反向代理配置
3. 检查防火墙端口是否开放

### Q4: 如何查看日志？

**A**: 
- 后端日志：Python 项目设置 → 「日志」
- Nginx 日志：网站设置 → 「日志」
- 系统日志：宝塔面板 → 「日志」

---

## 🎉 完成！

现在您的项目应该已经部署成功了！

访问您的域名或 IP，应该能看到前端界面。

---

## 📞 需要帮助？

如果遇到问题：
1. 查看日志文件
2. 检查配置是否正确
3. 截图错误信息，我可以帮您解决

---

**开始部署吧！** 🚀


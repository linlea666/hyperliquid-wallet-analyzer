# æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æ–¹æ¡ˆ

## ðŸ“¦ éƒ¨ç½²å‰å‡†å¤‡

### 1. å‡†å¤‡éƒ¨ç½²æ–‡ä»¶

é¡¹ç›®å·²åŒ…å«æ‰€æœ‰å¿…è¦æ–‡ä»¶ï¼Œç›´æŽ¥æ‰“åŒ…ä¸Šä¼ å³å¯ï¼š

```bash
# åœ¨æœ¬åœ°æ‰“åŒ…ï¼ˆæŽ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶ï¼‰
cd /Users/huahua/Documents/gendan
zip -r gendan-deploy.zip . \
  -x "*.git*" \
  -x "*.DS_Store" \
  -x "node_modules/*" \
  -x "backend/venv/*" \
  -x "backend/logs/*" \
  -x "logs/*" \
  -x "*.pid" \
  -x "frontend/dist/*"
```

### 2. æœåŠ¡å™¨è¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Linux (CentOS 7+/Ubuntu 18+/Debian 10+)
- **Python**: 3.10+
- **Node.js**: 18+
- **å†…å­˜**: å»ºè®® 2GB+
- **ç£ç›˜**: å»ºè®® 10GB+
- **å®å¡”é¢æ¿**: å·²å®‰è£…ï¼ˆæŽ¨èï¼‰

---

## ðŸš€ ä¸€é”®éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1: ä¸Šä¼ é¡¹ç›®æ–‡ä»¶

**æ–¹å¼ä¸€ï¼šé€šè¿‡å®å¡”é¢æ¿**
1. ç™»å½•å®å¡”é¢æ¿
2. è¿›å…¥ã€Œæ–‡ä»¶ã€ç®¡ç†
3. è¿›å…¥ `/www/wwwroot/` ç›®å½•
4. ä¸Šä¼  `gendan-deploy.zip`
5. è§£åŽ‹æ–‡ä»¶ï¼Œé‡å‘½åä¸º `gendan`

**æ–¹å¼äºŒï¼šé€šè¿‡ SSH**
```bash
# ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨åŽ
cd /www/wwwroot
unzip gendan-deploy.zip
mv gendan-deploy gendan
cd gendan
```

### æ­¥éª¤ 2: è¿è¡Œä¸€é”®éƒ¨ç½²è„šæœ¬

```bash
cd /www/wwwroot/gendan
chmod +x deploy.sh
./deploy.sh
```

éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… æ£€æŸ¥ Python å’Œ Node.js
- âœ… åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒ
- âœ… å®‰è£…åŽç«¯ä¾èµ–ï¼ˆä½¿ç”¨å›½å†…é•œåƒï¼‰
- âœ… å®‰è£…å‰ç«¯ä¾èµ–ï¼ˆä½¿ç”¨å›½å†…é•œåƒï¼‰
- âœ… æž„å»ºå‰ç«¯ç”Ÿäº§ç‰ˆæœ¬
- âœ… ä½¿ç”¨ PM2 å¯åŠ¨åŽç«¯æœåŠ¡
- âœ… é…ç½®å¼€æœºè‡ªå¯

### æ­¥éª¤ 3: é…ç½® Nginx

#### 3.1 åœ¨å®å¡”é¢æ¿åˆ›å»ºç½‘ç«™

1. è¿›å…¥ã€Œç½‘ç«™ã€â†’ã€Œæ·»åŠ ç«™ç‚¹ã€
2. å¡«å†™ä¿¡æ¯ï¼š
   - **åŸŸå**: æ‚¨çš„åŸŸåï¼ˆå¦‚ `wallet.yourdomain.com`ï¼‰æˆ– IP
   - **æ ¹ç›®å½•**: `/www/wwwroot/gendan/frontend/dist`
   - **PHPç‰ˆæœ¬**: çº¯é™æ€

#### 3.2 é…ç½® Nginx åå‘ä»£ç†

ç‚¹å‡»ç½‘ç«™ã€Œè®¾ç½®ã€â†’ã€Œé…ç½®æ–‡ä»¶ã€ï¼Œæ›¿æ¢ä¸ºä»¥ä¸‹é…ç½®ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;  # æ›¿æ¢ä¸ºæ‚¨çš„åŸŸå
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    root /www/wwwroot/gendan/frontend/dist;
    index index.html;
    
    # å‰ç«¯è·¯ç”±ï¼ˆæ”¯æŒ Vue Routerï¼‰
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # åŽç«¯ API ä»£ç†
    location /api {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # è¶…æ—¶è®¾ç½®
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
    
    # WebSocket æ”¯æŒï¼ˆå¦‚æžœéœ€è¦ï¼‰
    location /ws {
        proxy_pass http://127.0.0.1:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
    
    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

#### 3.3 ä¿å­˜å¹¶é‡å¯ Nginx

ç‚¹å‡»ã€Œä¿å­˜ã€ï¼Œç„¶åŽé‡å¯ Nginxã€‚

### æ­¥éª¤ 4: é…ç½®é˜²ç«å¢™

åœ¨å®å¡”é¢æ¿ï¼š
1. è¿›å…¥ã€Œå®‰å…¨ã€
2. å¼€æ”¾ç«¯å£ï¼š
   - `8000` - ä»…æœ¬åœ°è®¿é—®ï¼Œå¯ä¸å¼€æ”¾ï¼‰
   - `80`ï¼ˆHTTPï¼‰
   - `443`ï¼ˆHTTPSï¼Œå¦‚æžœä½¿ç”¨ SSLï¼‰

### æ­¥éª¤ 5: é…ç½® SSLï¼ˆå¯é€‰ä½†æŽ¨èï¼‰

1. è¿›å…¥ç½‘ç«™ã€Œè®¾ç½®ã€â†’ã€ŒSSLã€
2. é€‰æ‹©ã€ŒLet's Encryptã€å…è´¹è¯ä¹¦
3. ç‚¹å‡»ã€Œç”³è¯·ã€
4. å¼€å¯ã€Œå¼ºåˆ¶ HTTPSã€

---

## âœ… éƒ¨ç½²éªŒè¯

### 1. æ£€æŸ¥åŽç«¯æœåŠ¡

```bash
# SSH ç™»å½•æœåŠ¡å™¨
pm2 status

# åº”è¯¥çœ‹åˆ° hyperliquid-backend è¿è¡Œä¸­
# æŸ¥çœ‹æ—¥å¿—
pm2 logs hyperliquid-backend --lines 50
```

### 2. æ£€æŸ¥å‰ç«¯æ–‡ä»¶

```bash
ls -la /www/wwwroot/gendan/frontend/dist
# åº”è¯¥çœ‹åˆ° index.html ç­‰æ–‡ä»¶
```

### 3. è®¿é—®æµ‹è¯•

åœ¨æµè§ˆå™¨è®¿é—®ï¼š
- **å‰ç«¯ç•Œé¢**: `http://your-domain.com`
- **åŽç«¯ API**: `http://your-domain.com/api/health`
- **API æ–‡æ¡£**: `http://your-domain.com/api/docs`

---

## ðŸ”§ æœåŠ¡ç®¡ç†

### å¯åŠ¨/åœæ­¢/é‡å¯

```bash
# å¯åŠ¨
pm2 start hyperliquid-backend

# åœæ­¢
pm2 stop hyperliquid-backend

# é‡å¯
pm2 restart hyperliquid-backend

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs hyperliquid-backend
```

### æŸ¥çœ‹åº”ç”¨æ—¥å¿—

```bash
# åŽç«¯åº”ç”¨æ—¥å¿—
tail -f /www/wwwroot/gendan/backend/logs/app.log

# åŽç«¯é”™è¯¯æ—¥å¿—
tail -f /www/wwwroot/gendan/backend/logs/error.log

# Nginx è®¿é—®æ—¥å¿—
tail -f /www/wwwlogs/your-domain.com.log
```

---

## ðŸ“ é…ç½®æ–‡ä»¶è¯´æ˜Ž

### åŽç«¯é…ç½®

ç¼–è¾‘ `/www/wwwroot/gendan/backend/data/config/system.json`ï¼š

```json
{
  "api": {
    "base_url": "https://api.hyperliquid.xyz/info",
    "timeout": 30,
    "retry_times": 3,
    "retry_delay": 1,
    "use_mock": false  // ç”Ÿäº§çŽ¯å¢ƒå¿…é¡»ä¸º false
  }
}
```

### æ•°æ®ç›®å½•æƒé™

```bash
chown -R www:www /www/wwwroot/gendan/backend/data
chown -R www:www /www/wwwroot/gendan/backend/logs
chmod -R 755 /www/wwwroot/gendan/backend/data
chmod -R 755 /www/wwwroot/gendan/backend/logs
```

---

## ðŸ”„ æ›´æ–°ä»£ç ï¼ˆæœ¬åœ°å¼€å‘åŽï¼‰

### 1. æœ¬åœ°å¼€å‘æµ‹è¯•

åœ¨æœ¬åœ°ä¿®æ”¹ä»£ç å¹¶æµ‹è¯•ï¼š
```bash
cd /Users/huahua/Documents/gendan
# ä¿®æ”¹ä»£ç ...
# æµ‹è¯•...
```

### 2. æ‰“åŒ…æ›´æ–°æ–‡ä»¶

```bash
# åªæ‰“åŒ…ä¿®æ”¹çš„æ–‡ä»¶ï¼ˆæŽ’é™¤ node_modulesã€venv ç­‰ï¼‰
zip -r update.zip backend/app frontend/src \
  -x "*.git*" \
  -x "node_modules/*" \
  -x "backend/venv/*"
```

### 3. ä¸Šä¼ åˆ°æœåŠ¡å™¨

é€šè¿‡å®å¡”é¢æ¿æˆ– SCP ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚

### 4. æœåŠ¡å™¨æ›´æ–°

```bash
cd /www/wwwroot/gendan

# å¤‡ä»½å½“å‰ç‰ˆæœ¬
cp -r backend/app backend/app.backup
cp -r frontend/src frontend/src.backup

# è§£åŽ‹æ›´æ–°æ–‡ä»¶
unzip -o update.zip

# é‡æ–°æž„å»ºå‰ç«¯
cd frontend
npm run build

# é‡å¯åŽç«¯
pm2 restart hyperliquid-backend
```

---

## ðŸ› å¸¸è§é—®é¢˜

### 1. PM2 æœªæ‰¾åˆ°

```bash
npm install -g pm2
pm2 startup
pm2 save
```

### 2. ç«¯å£è¢«å ç”¨

```bash
# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 8000

# ä¿®æ”¹ç«¯å£ï¼ˆç¼–è¾‘ start-backend.shï¼‰
# å°† --port 8000 æ”¹ä¸ºå…¶ä»–ç«¯å£
```

### 3. æƒé™é—®é¢˜

```bash
chown -R www:www /www/wwwroot/gendan
chmod -R 755 /www/wwwroot/gendan
```

### 4. å‰ç«¯ 404 é”™è¯¯

ç¡®ä¿ Nginx é…ç½®äº† `try_files $uri $uri/ /index.html;`

### 5. API è¯·æ±‚å¤±è´¥

æ£€æŸ¥ï¼š
- Nginx åå‘ä»£ç†é…ç½®æ˜¯å¦æ­£ç¡®
- åŽç«¯æœåŠ¡æ˜¯å¦è¿è¡Œï¼š`pm2 status`
- åŽç«¯æ—¥å¿—ï¼š`pm2 logs hyperliquid-backend`

---

## ðŸ“Š ç›‘æŽ§å’Œç»´æŠ¤

### è®¾ç½®æ—¥å¿—è½®è½¬

```bash
# ç¼–è¾‘ PM2 é…ç½®
pm2 install pm2-logrotate
pm2 set pm2-logrotate:max_size 10M
pm2 set pm2-logrotate:retain 7
```

### å®šæœŸå¤‡ä»½æ•°æ®

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
cat > /www/wwwroot/gendan/backup.sh << 'EOF'
#!/bin/bash
BACKUP_DIR="/www/backup/gendan"
mkdir -p $BACKUP_DIR
DATE=$(date +%Y%m%d_%H%M%S)
tar -czf $BACKUP_DIR/gendan_$DATE.tar.gz \
  /www/wwwroot/gendan/backend/data \
  /www/wwwroot/gendan/backend/logs
# ä¿ç•™æœ€è¿‘7å¤©å¤‡ä»½
find $BACKUP_DIR -name "gendan_*.tar.gz" -mtime +7 -delete
EOF

chmod +x /www/wwwroot/gendan/backup.sh

# æ·»åŠ åˆ°å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½ï¼‰
crontab -e
# æ·»åŠ ï¼š0 2 * * * /www/wwwroot/gendan/backup.sh
```

---

## ðŸŽ¯ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] é¡¹ç›®æ–‡ä»¶å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] Python 3.10+ å·²å®‰è£…
- [ ] Node.js 18+ å·²å®‰è£…
- [ ] è¿è¡Œ `./deploy.sh` æˆåŠŸ
- [ ] PM2 æœåŠ¡è¿è¡Œæ­£å¸¸
- [ ] å‰ç«¯å·²æž„å»ºï¼ˆdist ç›®å½•å­˜åœ¨ï¼‰
- [ ] Nginx é…ç½®æ­£ç¡®
- [ ] ç½‘ç«™å¯ä»¥è®¿é—®
- [ ] API å¯ä»¥è®¿é—®
- [ ] SSL è¯ä¹¦å·²é…ç½®ï¼ˆå¯é€‰ï¼‰
- [ ] é˜²ç«å¢™ç«¯å£å·²å¼€æ”¾
- [ ] æ•°æ®ç›®å½•æƒé™æ­£ç¡®

---

## ðŸŽ‰ éƒ¨ç½²å®Œæˆ

éƒ¨ç½²æˆåŠŸåŽï¼š

- **å‰ç«¯ç•Œé¢**: `http://your-domain.com`
- **åŽç«¯ API**: `http://your-domain.com/api`
- **API æ–‡æ¡£**: `http://your-domain.com/api/docs`

---

## ðŸ“ž åŽç»­æ”¯æŒ

- æŸ¥çœ‹æ—¥å¿—æŽ’æŸ¥é—®é¢˜
- ä½¿ç”¨ PM2 ç®¡ç†æœåŠ¡
- å®šæœŸå¤‡ä»½æ•°æ®
- æ›´æ–°ä»£ç æ—¶å‚è€ƒã€Œæ›´æ–°ä»£ç ã€ç« èŠ‚

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ðŸš€

